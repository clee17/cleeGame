<style>
    .workInfo{
        border:1px solid rgba(205,205,205,255);
        box-shadow:0px 0px 8px rgba(215,215,215,188);
        display:flex;
        flex-direction:column;
        padding-top:15px;
        padding-bottom:0;
        font-size:14px;
        margin-left:auto;
        margin-right:auto;
        margin-bottom:2rem;
        width:85%;
        color:rgba(108,95,93,255);
        flex:1;
        height:auto;
        min-width:40rem;
        max-width:60rem;
    }

    .workInfo >div:nth-last-child(n+3){
        margin-left:60px;
        margin-right:30px;
    }
    .workInfo >div:nth-last-child(n+3){
        line-height:1.5rem;
        margin-bottom:5px;
    }
    .workInfo >div:first-child{
        line-height:1.8rem;
        color:rgba(131,131,131,255);
        margin-left:45px;
    }

    .workInfo >div:nth-child(2) {
        line-height:1rem;
        margin-bottom:18px;
        margin-top:1px;
        margin-left:60px;
    }

    .workInfo >div:nth-child(2) >div:nth-child(odd){
        margin-left:15px;
    }


    .workInfo >div:first-child a{
        font-weight:bold;
        color:rgba(108,95,93,255);
        text-decoration:none;
        font-size:16px;
    }

    .workInfo >div:first-child >div{
        line-height:1.5rem;
        height:1.5rem;
    }

    .workInfo >div:first-child a:hover{
        text-decoration:underline;
    }


    .editRow{
        margin-top:10px;
        padding-bottom:10px;
        display:flex;
        flex-direction:row;
    }

    .editButton{
        margin-left:15px;
        background:rgba(0,0,0,0);
        border:none;
        color:rgba(138,138,138,255);
    }

    .editButton:first-child{
        margin-left:auto;
    }

    .editRow a{
        background:rgba(0,0,0,0);
        border:none;
        color:rgba(138,138,138,255);
        text-decoration:none;
        font-size:14px;
    }

    .editRow a:hover{
        color:rgba(181,181,181,255);
    }

    .editButton:hover{
        color:rgba(181,181,181,255);
    }

    .likedButton{
        color:darkred;
        font-weight:bold;
        background:none;
        border:none;
        margin-left:15px;
    }

    .likedButton:hover{
        color:orangered;
    }

    .feedbackInfo{
        border-top:1px solid rgba(205,205,205,255);
        box-shadow:0px 0px 8px rgba(215,215,215,188) inset;
        min-height:2rem;
    }

    .feedbackInfo >div{
        padding-left:40px;
        min-height:2rem;
        border-bottom:1px solid rgba(205,205,205,255);
        margin-left:0;
        display:flex;
        flex-direction:column;
    }

    .feedbackInfo >div >div{
        margin-top:auto;
        margin-bottom:auto;
    }


    .feedbackInfo >div:last-child{
        border-bottom:none;
    }

    .feedbackEntry {
        margin-left:40px;
    }

    .feedbackEntry a{
        margin-right:10px;
        text-decoration:none;
        color:rgba(158,142,166,255);
        font-weight:bold;
    }

    .feedbackEntry a:hover{
        margin-right:10px;
        text-decoration:none;
        color:rgba(139,100,127,255);
    }

</style>

<div style="display:flex;flex-direction:column;flex:1;" class="workInfo work-info-outer">
    <div style="display:flex;flex-direction:row;">
        <div class="grade" grade-show grade="{{item.chapter.grade}}">{{item.chapter.grade | grade:gradeTemplate }} </div>
        <div><a href="{{ item | workInfoLink:type }}">{{item | workInfoTitle:type}}</a></div>
        <div ng-show="item.infoType==0" style="margin-left:2rem;font-weight:bold;border-radius:5px;border:2px solid rgba(107,187,167,218);color:rgba(107,187,167,218);padding-left:4px;padding-right:4px;height:1.2rem;line-height:1.2rem;">新的作品</div>
        <div style="margin-left:auto;">{{item | workInfoDate:type}}</div>
    </div>
    <div class="tagRow">
        <div>作者:</div>
        <a href="{{'/users/'+item.chapter.user._id}}">{{item.chapter.user.user}}</a>
        <div>总字数:</div>
        <div>{{item | workInfoWordCount:type}}</div>
        <div ng-show="item.infoType== 0">总章节数:</div>
        <div ng-show="item.infoType== 0">{{item.work.chapterCount}}</div>
        <div>浏览量:</div>
        <div>{{item | workInfoVisited:type}}</div>
        <div ng-show="item.infoType != 0">属于作品:</div>
        <div ng-show="item.infoType != 0"><a href="{{'/fanfic/work/'+item.work.id}}">{{item.work.title}}</a></div>
        <div>更新状态:</div>
        <div>{{item.work.status | workInfoStatus}}</div>
    </div>
    <div class="tagRow">
        <div style="margin-right:10px;margin-top:auto;margin-bottom:auto;height:1rem;line-height:1rem;">基于作品:</div>
        <a ng-repeat="fandom in item.chapter.fandom" href="{{searchTag(fandom,0)}}" class="tag">{{fandom}}</a>
    </div>
    <div class="tagRow">
        <div style="margin-right:10px;margin-top:auto;margin-bottom:auto;height:1rem;line-height:1rem;">人物关系:</div>
        <a ng-repeat="relation in item.chapter.relationships" href="{{searchTag(relation,1)}}" class="tag">{{relation}}</a>
    </div>
    <div class="tagRow">
        <div style="margin-right:10px;margin-top:auto;margin-bottom:auto;height:1rem;line-height:1rem;">登场角色:</div>
        <a ng-repeat="character in item.chapter.characters" href="{{searchTag(character,2)}}" class="tag">{{character}}</a>
    </div>
    <div class="tagRow">
        <div style="margin-right:10px;margin-top:auto;margin-bottom:auto;height:1rem;line-height:1rem;">其他标签:</div>
        <a ng-repeat="tag in item.chapter.tag" href="{{searchTag(tag,3)}}" class="tag">{{tag}}</a>
    </div>
    <div>
        <div>作品简介:</div>
        <div style="margin-left:20px;">{{item.chapter.intro | introType}}</div>
    </div>
    <div class="editRow">
        <button class="editButton" ng-click="deleteItem()" ng-if="item.work.user == readerId">删除</button>
        <button class="editButton"><a href="{{'/fanfic/post/edit?id='+item.index._id}}" ng-if="item.work.user == readerId" target="_blank">编辑</a></button>
        <button class="editButton" ng-click="showFeedbackList()" ng-show="(item.work.liked+ item.work.bookmarked )>0">热度({{item.work.liked+ item.work.bookmarked}})</button>
        <button ng-class="{'editButton':!liked,'likedButton':liked}" ng-show="item.work.user != readerId" ng-click="likeIt()"><span ng-show="liked">已点赞</span><span ng-show="!liked">点赞</span>({{item.work.liked}})</button>
        <button ng-class="{'editButton':!bookMarked,'likedButton':bookMarked}" ng-show="item.work.user != readerId" ng-click="bookMarkIt()"><span ng-show="bookMarked">已收藏</span><span ng-show="!bookMarked">收藏</span>({{item.work.bookmarked}})</button>
        <button class="editButton" ng-click="showCommentList()">评论(<span ng-show="item.infoType ===0">{{item.work.comments}}</span><span ng-show="item.infoType ===1">{{item.chapter.comments}}</span>)</button>
    </div>
    <div ng-show="showFeedBack" class="feedbackInfo work-info-outer">
        <div style="border-bottom:none;"><div class="feedbackEntry" ng-show="item.work.visitorLiked >0">共有<b style="margin-left:5px;margin-right:5px;">{{item.work.visitorLiked}}</b>名游客点赞了您</div></div>
        <div style="min-height:15px;" ng-show="feedback.length>0"></div>
        <div ng-repeat="feedback in feedback">
           <div class="feedbackEntry"><a href="{{'/users/'+feedback.user}}" target="_blank">{{feedback.userName}}</a> <span ng-if="feedback.type==1">点赞了</span><span ng-if="feedback.type==2">收藏了</span>此作品</div>
        </div>
        <div style="min-height:3rem;" ng-show="requestingFeed">
        </div>
        <div style="min-height:3rem;" ng-show="feedback.length>15">
            <div style="margin-top:auto;margin-bottom:15px;"><button class="editButton" style="margin-right:auto;margin-left:0" ng-click="showFeedbackList()">收起 <i class="fas fa-angle-up"></i></button></div>
        </div>
    </div>
    <div ng-show="showComment" class="feedbackInfo work-info-outer">
        <comment-info></comment-info>
    </div>
</div>